<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <h2>Add Story</h2>
    <label for="">Title</label>
    <input class="story-title"type="text" placeholder="What's this about?">
    
    <div class="topics-container">
        <label for="">Topics</label>
        <div id="topic">Politics</div>
        <div id="topic">Sport</div>
        <div id="topic">Science</div>
        <div id="topic">Culture</div>
        <div id="topic">Environment</div>
        <div id="topic">Entertainment</div>
        <div id="topic">Economy</div>
        <div id="topic">Society</div>
    </div>

    <label for="">Article</label>
    <input class="url-or-keyword" type="text" placeholder="URL or search Google">
    

    <button>Preview</button>
    
    <button class="google-news-btn">Google News</button>
    
    <div class="news-container"></div>






    <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
    <script>

        var getUrlOrKeyword = document.querySelector('.url-or-keyword')
        var setNewsContainer = document.querySelector('.news-container')
        var searchGoogleNews = document.querySelector('.google-news-btn')
        var getStoryTitle = document.querySelector('.story-title')
        var getTopics = document.querySelectorAll('#topic')

        var handleSearchGoogleNews = function(event) {
            
            var options = {
                url: `https://newsapi.org/v2/everything?q=${getUrlOrKeyword.value}&apiKey=cf309649c7dd4427b754becfef57272c`,
                method: 'get'
            }

            var handleDone = function(res) {
                // array
                for(let i = 0; i < res.articles.length; i++) {
                    var div = document.createElement('div')
                    setNewsContainer.append(div)
                    div.innerHTML = 
                    `<h3>${res.articles[i].title}</h3>
                    <div class="article-container"> 
                        <div><img src="${res.articles[i].urlToImage}"></div>
                        <div> 
                            <p>${res.articles[i].description}</p>
                            <a href="${res.articles[i].url}" target="_blank">${res.articles[i].url}</a>
                            <div><button class="choose-btn">Choose</button></div>
                        </div>
                    </div>`

                    // choose-btn eventlister goes here
                    getTopics.forEach(topic => {
                        if() {
                            
                        }
                    })


                    var chooseArticleButtons = document.querySelectorAll('.choose-btn')
                    chooseArticleButtons.forEach(chooseArticleButton => {
                        chooseArticleButton.addEventListener('click', function() {
                            $.ajax({
                                url: '/articles',
                                method: 'post',
                                data: {
                                    story_title: getStoryTitle.value
                                    
                                }
                            })
                        })
                    })
                }

            }
            $.ajax(options).done(handleDone)
        }

        var handleSelectTopics = function (event) {
            event.target.classList.toggle('selectedTopics')
        }

        getTopics.forEach(function(item) {
            item.addEventListener('click', handleSelectTopics)
        })
    
        searchGoogleNews.addEventListener('click', handleSearchGoogleNews)
    </script>
</body>
</html>